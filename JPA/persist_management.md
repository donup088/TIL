### 엔티티 조회
1. 1차 캐시에 있다면 1차 캐시에서 조회해온다.
2. 1차 캐시에 없다면 DB를 조회해서 1차 캐시에 등록 한 후 조회해온다.

### Transaction
- em.persist()를 할 때 쿼리가 나가지 않고 쓰기 지연 SQL 저장소에 쿼리가 쌓인다. 트랜잭션 커밋이 될 떄 DB에 쿼리가 보내진다.

### 엔티티 수정
- JPA에서는 엔티티를 수정할 때 변경감지를 사용한다.
    ```
    ...
    Member member = em.find(Member.class, 1L);
    member.setName("변경된 이름");
    ```
- 1차 캐시에서 Entity와 스냅샷(변경되지 않은 최초의 값) 과 비교하여 바뀌어 있다면 update 쿼리를 쓰기 지연 SQL 저장소에 보낸다. 트랙잭션 커밋이 되면 DB에 반영되어 엔티티가 수정된다.

### Flush
- 영속성 컨텍스트의 변경내용을 DB에 반영한다.
- em.flush() 사용, 트랜잭션 커밋, JPQL 쿼리 실행
- 트랜잭션이라는 것은 작업 단위이다. 따라서 커밋 직전에만 동기화하면된다.

### 준영속 상태
- 영속 상태의 엔티티가 영속성 컨텍스트에서 분리된 것이다.
- 영속성 컨텍스트의 기능을 사용하지 못한다.
- em.detach(entity), em.clear(), em.close 사용.