# 우아한모노리스 세미나 정리(https://www.youtube.com/watch?v=SrQeIz3gXZg)

## 모노리스 와 마이크로서비스

### 모노리틱이 가진 주요 단점과 한계
- 예상치 못한 결합
- 늦은 출시 싸이클
- 높은 테스트 비용
- 부족한 장애 내성
    - 부분의 장애가 전체 시스템의 장애로 이어질 수 있다.
- 단일 확장성
    - 트래픽이 많아져서 서버를 확장해야한다면 똑같은 기능을 가진 서버를 늘리고 앞에 로드밸런서를 두는 수평적확장을 해야한다.
- 코드를 작성하다보면 의도한 것이 아니지만 코드들이 강하게 결합될 수 있다. -> 테스트 비용이 증가한다. -> 배포가 늦어진다.

### 마이크로서비스가 주는 주요 혜택
- 아키텍쳐와 시스템의 구조를 조직의 구조와 맞춰 정렬되면 서로 협업 시너지가 극대화된다.
- 회복성
- 조합성
- 대체가능성
- 확장성
- 조직부합성
- 배포용이성

### 큰 진흙 덩어리형 모노리스을 개선하자.
- 응집과 결합을 관리하자. (높은 응집도와 낮은 결합도)
- 적은 비용으로 변경할 수 있는 구조 만들기

### 모노리스 ? 마이크로서비스? 어떤 것을 선택해야할까?
- 모노리스 
    - 단일 프로젝트에 모든 코드가 모여있다.
    - 시스템의 구조가 간결하고 빠르게 구축 가능하다.
    - 테스트 및 배포 파이프라인 구성이 간단하다.
    - 인프라스트럭처 구축와 운용이 간결하다.
- 마이크로서비스
    - 시스템을 조직 구조에 맞게 더 적절히 정렬할 수 있다.
    - 서비스를 독립적으로 배포 또는 확장할 수 있다.
    - 서비스 장애가 시스템 전체 장애로 전파되지 않는다.
    - 문제 해결에 특화된 다양한 기술을 도입할 수 있다.

- 주어진 상황에 따라 적절한 도구를 선택하자.

### 모듈형 모노리스로 개선
- 모듈화
    - 시스템 내에 잘 정의된 경계를 도입해 소프트웨어 복잡성을 다룬다.
    - 결합은 모듈들 사이의 관계에 집중한다.
    - 응집은 모듈 내부의 상태에 집중한다.
- 변경을 수용할 수 있는 소프트웨어 아키텍처
    - 내부영역은 도메인 개념을 구현한 코드가 배치되고, 외부 영역은 구현 세부사항(UI,데이터베이스 등)과 상호작용하는 코드를 배치한다. 외부에서 내부로 접근하는 의존방향을 항상 유지한다.

---

## 모듈형 모노리스 

### 도메인 중심으로 응집도 높은 모듈 구성하기
- orders
    - domain
        -entity
        -usecase
    - interate
    -data
    -web

### 계층 구조로 모듈화
- 도메인을 기준으로 경계를 치고 계층 구조로 나눈다.
- 새로운 기능을 추가할 때도 해당 모듈을 수정하면 된다.
- 독립적으로 모듈을 키워나갈 수 있다.

### 관심사에 따른 모듈화
- 수직적 관심사
    - 비즈니스와 응용 프로그램에 특화된 기능
    - 재사용성이 첫번째가 아니다. 어떻게 핵심적인 비즈니스 로직을 구현할 수 있는 지가 첫번째이다.
- 수평적 관심사
    - 로깅, 보안 등 공통적인 저수준 기능

### 의존성 관리로 느슨하게 결합된 모듈 설계하기
- 모듈간 순환적 의존 관계가 형성되지 않도록 설계한다.

### 모듈사이 경계를 넘어오지 못하게 하기
- 모듈내 구현 세부사항을 밖에서 알아선 안된다.
- 모듈과 모듈은 공개된 인터페이스를 통해서 소통한다.
- 적절한 기시성으로 모듈 보호하기
- 멀티프로젝트 구성을 통해 의존성 분리하기
    - 각 모듈이 별도의 소스 구조를 갖추도록 gradle을 통해 개별 프로젝트를 구성하고 의존성을 분리한다.

### 컨텍스트간 협력을 위한 공개 API 내보내기
- 공개되지 않은 빈은 모듈 컨텍스트 전용
- 빈은 RootContext로 내보낸다. -> 공개된 빈을 사용하는 모듈에선 의존성을 주입받아 사용한다.